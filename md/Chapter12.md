# [Chapter 12](https://livebook.manning.com/book/modern-java-in-action/chapter-12/)

# 새로운 날짜와 시간 API

## 이 장의 내용

- 자바 8에서 새로운 날짜와 시간 라이브러리를 제공하는 이유
- 사람이나 기계가 이해할 수 있는 날짜와 시간 표현 방법
- 시간의 양 정의하기
- 날짜 조작 포매팅, 파싱
- 시간대와 캘린더 다루기


- 자바 1.0 : `java.util.Date`
    - Date 클래스는 특정 시점을 날짜가 아닌 밀리초 단위로 표현한다. 게다가 1900년을 기준으로 하는 오프셋, 0에서 시작하는 달 인덱스 등 모호한 설계로 유용성이
      떨어졌다.
- 자바 1.1 : `java.util.Calendar`
    - 1900년도에서 시작하는 오프셋은 없앴지만 여전히 달의 인덱스는 0부터 시작했다.
    - `Date`와 `Calendar` 두 가지 클래스가 등장하면서 개발자들에게 혼란이 가중
    - `DateFormat`은 스레드에 안전하지 않다. 즉, 두 스레드가 동시가 하나의 포매터 formatter로 날짜를 파싱할 때 예기치 못한 결과가 일어날 수 있다.
- `Date`와 `Calendar`는 모두 가변mutable 클래스
    - 유지보수가 아주 어려워짐
- 자바 8 : Joda-Time 서드파티 라이브러리의 많은 기능을 `java.time` 패키지로추가

## 12.1 Local Date, LocalTime, Instant, Duration, Period 클래스

- `Temporal` 인터페이스를 구현한 클래스들임
- `Temporal` 인터페이스는 특정 시간을 모델링하는 객체의 값을 어떻게 읽고 조작할지 정의함

### 12.1.1 Local Date와 LocalTime 사용

- 정적 팩토리 메서드 `of` 사용
- 팩토리 메서드 `now`는 시스템 시계의 정보를 이용해서 현재 날짜 정보를 얻는다.

### 12.1.2 날짜와 시간 조합

### 12.1.3 Instant 클래스: 기계의 날짜와 시간

- 사람과는 다르게 기계의 관점에서는 연속된 시간에서 특정 지점을 하나의 큰 수로 표현하는 것이 가장 자연스러운 시간 표현 방법이다. 새로운 `java.time.Instant`
  클래스에서는 이와 같은 기계적인 관점에서 시간을 표현한다. 즉, Instant 클래스는 유닉스 에포크 시간Unix epoch time(1970년 1월 1일 0시 0분 0초
  UTC)을 기준으로 특정 지점까지의 시간을 초로 표현한다.

### 12.1.4 Duration과 Period 정의

- ![표 12-1 간격을 표현하는 날짜와 시간 클래스의 공통 메서드](../res/img/table12-1.bmp)

## 12.2 날짜 조정, 파싱, 포매팅

- 함수형 갱신
  - 이런 `with` 메서드는 기존의 Temporal 객체를 바꾸는 것이 아니라 필드를 갱신한 복사본을 만든다
- ![표 12-2 특정 시점을 표현하는 날짜 시간 클래스의 공통 메서드](../res/img/table12-2.bmp)

### 12.2.1 TemporalAdjusters 사용하기

- ![표 12-3 TemporalAdjusters 클래스의 팩토리 메서드](../res/img/table12-3.bmp)
- https://docs.oracle.com/javase/8/docs/api/java/time/temporal/TemporalAdjusters.html

### 12.2.2 날짜와 시간 객체 출력과 파싱

## 12.3 다양한 시간대와 캘린더 활용 방법

### 12.3.1 시간대사용하기

### 12.3.2 UTC/Greenwich 기준의 고정 오프셋

### 12.3.3 대안 캘린더 시스템 사용하기

## 12.4 마치며

- 자바 8 이전 버전에서 제공하는 기존의 `java.util.Date` 클래스와 관련 클래스에서는 여러 불일치점들과 가변성, 어설픈 오프셋, 기본값, 잘못된 이름 결정 등의 설계
  결함이 존재했다.
- 새로운 날짜와 시간 API에서 날짜와 시간 객체는 모두 불변이다.
- 새로운 API는 각각 사람과 기계가 편리하게 날짜와 시간 정보를 관리할 수 있도록 두 가지 표현 방식을 제공한다.
- 날짜와 시간 객체를 절대적인 방법과 상대적인 방법으로 처리할 수 있으며 기존 인스턴스를 변환하지 않도록 처리 결과로 새로운 인스턴스가 생성된다.
- TemporalAdjuster를 이용하면 단순히 값을 바꾸는 것 이상의 복잡한 동작을 수행할 수 있으며 자신만의 커스텀 날짜 변환 기능을 정의할 수 있다.
- 날짜와 시간 객체를 특정 포맷으로 출력하고 파싱하는 포매터를 정의할 수 있다. 패턴을 이용하거나 프로그램으로 포매터를 만들 수 있으며 포매터는 스레드 안정성을 보장한다.
- 특정 지역/장소에 상대적인 시간대 또는 UTC/GMT 기준의 오프셋을 이용해서 시간대를 정의할 수 있으며 이 시간대를 날짜와 시간 객체에 적용해서 지 역화할 수 있다.
- ISO-8601 표준 시스템을 준수하지 않는 캘린더 시스템도 사용할 수 있다.